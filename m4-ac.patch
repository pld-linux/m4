--- m4/configure.in~	Thu Oct 31 19:36:20 2002
+++ m4/configure.in	Thu Oct 31 19:43:47 2002
@@ -2,8 +2,6 @@
 # Copyright (C) 1991-1998 Free Software Foundation, Inc.
 # Process this file with autoconf to produce a configure script.
 
-undefine([changeword])
-
 AC_INIT(src/m4.c)
 AM_CONFIG_HEADER(config.h)
 AC_ARG_PROGRAM
@@ -134,18 +134,10 @@
 
 dnl AC_LINK_FILES($nls_cv_header_libgt, $nls_cv_header_intl)
 
-LTLIBOBJS=`echo "$LIBOBJS" | sed 's,.o ,.lo ,g;s,.o$,.lo,'`
+LIB@&t@OBJS=`echo "$LIB@&t@OBJS" | sed 's,\.[[^.]]* ,$U&,g;s,\.[[^.]]*$,$U&,'`
+LTLIBOBJS=`echo "$LIB@&t@OBJS" | sed 's,\.[[^.]]* ,.lo ,g;s,\.[[^.]]*$,.lo,'`
 AC_SUBST(LTLIBOBJS)
 
-# This no-op line works around a bug in automake 1.4:
-# it doesn't recognize the assignment to LIBOBJS
-# in acm4/malloc.m4 and acm4/realloc.m4.
-# : LIBOBJS="$LIBOBJS malloc.o realloc.o"
-
-# This is necessary so that .o files in LIBOBJS are also built via
-# the ANSI2KNR-filtering rules.
-LIBOBJS=`echo $LIBOBJS|sed 's/\.o /\$U.o /g;s/\.o$/\$U.o/'`
-
 AC_OUTPUT(Makefile acm4/Makefile intl/Makefile po/Makefile.in doc/Makefile \
 lib/Makefile src/Makefile modules/Makefile tests/Makefile examples/Makefile, \
 [sed -e "/POTFILES =/r po/POTFILES" po/Makefile.in > po/Makefile; \
